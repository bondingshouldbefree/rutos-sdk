index 728ee8685..be48df7c7 100644
--- a/editors/awk.c
+++ b/editors/awk.c
@@ -1152,9 +1152,11 @@ static uint32_t next_token(uint32_t expe
 					s[-1] = bb_process_escape_sequence((const char **)&pp);
 					if (*p == '\\')
 						*s++ = '\\';
-					if (pp == p)
+					if (pp == p) {
+						if (*p == '\0')
+							syntax_error(EMSG_UNEXP_EOS);
 						*s++ = *p++;
-					else
+					} else
 						p = pp;
 				}
 			}
