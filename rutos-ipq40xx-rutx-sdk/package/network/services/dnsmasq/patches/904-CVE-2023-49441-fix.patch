Index: dnsmasq-2.89/src/hash-questions.c
===================================================================
--- dnsmasq-2.89.orig/src/hash-questions.c
+++ dnsmasq-2.89/src/hash-questions.c
@@ -165,7 +165,7 @@ static void sha256_transform(SHA256_CTX
   WORD a, b, c, d, e, f, g, h, i, j, t1, t2, m[64];
   
   for (i = 0, j = 0; i < 16; ++i, j += 4)
-    m[i] = (data[j] << 24) | (data[j + 1] << 16) | (data[j + 2] << 8) | (data[j + 3]);
+    m[i] = (((WORD)data[j]) << 24) | (((WORD)data[j + 1]) << 16) | (((WORD)data[j + 2]) << 8) | (((WORD)data[j + 3]));
   for ( ; i < 64; ++i)
     m[i] = SIG1(m[i - 2]) + m[i - 7] + SIG0(m[i - 15]) + m[i - 16];
 
